<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>(WebPKI.org Support)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="generator" content="javadoc/DocFileWriter">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body class="doc-file-page">
<script type="text/javascript"></script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="../package-summary.html">Package</a></li>
<li>Class</li>
<li><a href="../../../../overview-tree.html">Tree</a></li>
<li><a href="../../../../help-doc.html#doc-file">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list"></div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main"><h1 id="non-finite-numbers-heading">Non-Finite Numbers</h1>
Unlike JSON&nbsp;[<a href='https://www.rfc-editor.org/rfc/rfc8259.html' class='webpkilink'>RFC&nbsp;8259</a>],
CBOR supports the non-finite floating-point constructs defined by <span style='white-space:nowrap'><code>IEEE</code> <code>754</code></span>, known as
<code>NaN</code> (not a number) and <code>Infinity</code>.
This implementation provides multiple levels of support, intended to
accommodate different needs.
This is accomplished without specific decoder or encoder options;
it is entirely based on API method selections.
The following table outlines the supported alternatives:
<div class='webpkifloat' style='margin-left:2em'><table class='webpkitable' style='min-width:30em'>
<tr><th>Designation</th><th>Comment</th></tr>
<tr><td style='text-align:center'><code>BASIC</code></td><td>Only "regular" floating-point numbers are accepted.
</td></tr>
<tr><td style='text-align:center'><code>EXTENDED</code></td><td>All floating-point numbers except for non-trivial <code>NaNs</code> are accepted.
<div style='margin-top:0.5em'>In the list below, <code>NaN</code> refers to "simple" <code>NaNs</code>
(in deterministically encoded CBOR represented by <code>f97e00</code>),
while <code>Infinity</code> refers to
positive infinity (<code>f97c00</code>) and negative infinity (<code>f9fc00</code>).
The Java counterparts are represented by <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Double.html#NaN" title="class or interface in java.lang" class="external-link"><code>Double.NaN</code></a>,
<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Double.html#POSITIVE_INFINITY" title="class or interface in java.lang" class="external-link"><code>Double.POSITIVE_INFINITY</code></a>,
and <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Double.html#NEGATIVE_INFINITY" title="class or interface in java.lang" class="external-link"><code>Double.NEGATIVE_INFINITY</code></a> respectively.</div>
</td></tr>
<tr><td style='text-align:center'><code>COMPLETE</code></td><td>All floating-point numbers are accepted.
</td></tr>
</table></div>
Non-supported items cause a <a href="../CBORException.html" title="class in org.webpki.cbor"><code>CBORException</code></a> to be thrown.
Note that the constraints apply to <i>encoding</i> as well.
<h5 id="encoding-methods-heading" style='margin:1.3em 0 1em 0'>Encoding Methods</h5>
<div class='webpkifloat'>
<table style='margin-left:2em;font-family: monospace;white-space:nowrap;border-spacing:0'>
<tr><td colspan='2'>BASIC</td></tr>
<tr><td style='padding-left:1.5em'>new&nbsp;<a href="../CBORFloat.html#%3Cinit%3E(double)"><code>CBORFloat(double)</code></a></td><td>// "Regular" number</td></tr>
<tr><td colspan='2' style='padding-top:0.8em'>EXTENDED</td></tr>
<tr><td style='padding-left:1.5em'><a href="../CBORFloat.html#createExtendedFloat(double)"><code>CBORFloat.createExtendedFloat(double)</code></a></td><td>// "Regular" number, NaN, or Infinity</td></tr>
<tr><td colspan='2' style='padding-top:0.8em'>COMPLETE</td></tr>
<tr><td style='padding-left:1.5em'>// Select suitable method:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td></td></tr>
<tr><td style='padding-left:1.5em'>new&nbsp;<a href="../CBORFloat.html#%3Cinit%3E(double)"><code>CBORFloat(double)</code></a></td><td>// "Regular" number</td></tr>
<tr><td style='padding-left:1.5em'>new&nbsp;<a href="../CBORNonFinite.html#%3Cinit%3E(long)"><code>CBORNonFinite(long)</code></a></td><td>// Arbitrary non-finite number</td></tr>
<tr><td style='padding-left:1.5em'><a href="../CBORNonFinite.html#createPayloadObject(long)"><code>CBORNonFinite.createPayloadObject(long)</code></a></td><td>// Application-specific data</td></tr>
</table>
</div>
<h5 id="decoding-methods-heading" style='margin:1.3em 0 1em 0'>Decoding Methods</h5>
<div class='webpkifloat'>
<table style='margin-left:2em;font-family: monospace;white-space:nowrap;border-spacing:0'>
<tr><td colspan='2'>BASIC</td></tr>
<tr><td style='padding-left:1.5em'>cborObject.<a href="../CBORObject.html#getFloat64()"><code>getFloat64()</code></a></td><td>// "Regular" number</td></tr>
<tr><td colspan='2' style='padding-top:0.8em'>EXTENDED</td></tr>
<tr><td style='padding-left:1.5em'>cborObject.<a href="../CBORObject.html#getExtendedFloat64()"><code>getExtendedFloat64()</code></a></td><td>// "Regular" number, NaN, or Infinity</td></tr>
<tr><td colspan='2' style='padding-top:0.8em'>COMPLETE</td></tr>
<tr><td style='padding-left:1.5em'>// Check what the decoder returned:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td></td></tr>
<tr><td colspan='2' style='padding-left:1.5em'>if (cborObject instanceof <a href="../CBORNonFinite.html" title="class in org.webpki.cbor"><code>CBORNonFinite</code></a> nf) {</td></tr>
<tr><td style='padding-left:1.5em'>&nbsp;&nbsp;// Non-finite number to process</td><td></td></tr>
<tr><td style='padding-left:1.5em'>&nbsp;&nbsp;// Select suitable method:</td><td></td></tr>
<tr><td style='padding-left:1.5em'>&nbsp;&nbsp;nf.<a href="../CBORNonFinite.html#getNonFinite64()"><code>getNonFinite64()</code></a></td><td>// Arbitrary non-finite number</td></tr>
<tr><td style='padding-left:1.5em'>&nbsp;&nbsp;nf.<a href="../CBORNonFinite.html#getPayload()"><code>getPayload()</code></a></td><td>// Application-specific data</td></tr>
<tr><td style='padding-left:1.5em'>} else {</td><td></td></tr>
<tr><td style='padding-left:1.5em'>&nbsp;&nbsp;// "Regular" number to process</td><td></td></tr>
<tr><td style='padding-left:1.5em'>&nbsp;&nbsp;cborObject.<a href="../CBORObject.html#getFloat64()"><code>getFloat64()</code></a></td><td>// "Regular" number</td></tr>
<tr><td style='padding-left:1.5em'>}</td><td></td></tr>
</table>
</div>
<h3 id='payload-option' style='padding-top:0.5em'>Payload Option</h3>
<div>
Traditionally, the non-finite number space is used for propagating
math-related problems such as division by zero.
</div>
<div style='margin-top:0.5em'>
However, in some cases there may be a desire providing more application specific data,
like information related to a faulty sensor that needs attention.
The <a href="../CBORNonFinite.html#createPayloadObject(long)"><code>CBORNonFinite.createPayloadObject(long)</code></a> and <a href="../CBORNonFinite.html#getPayload()"><code>CBORNonFinite.getPayload()</code></a>
methods were designed for this particular purpose.
To obviate the need defining another CBOR type, these methods
are "piggybacking" on the existing non-finite number space.
The following table represents these methods from a <i>developer</i> perspective:
</div>
<div class='webpkifloat'><table class='webpkitable' style='margin-left:2em'>
<tr><th>Payload</th></tr>
<tr><td><code>d51-d0</code> in <i>big-endian</i> order</td></tr>
</table></div>
<div style='margin-top:0.5em'>
The payload bits are conceptually put into an <span style='white-space:nowrap'><code>IEEE</code> <code>754</code></span>
<code>64</code>-bit object having the following layout:
</div>
<div class='webpkifloat'><table class='webpkitable' style='margin-left:2em'>
<tr><th>Sign</th><th>Exponent</th><th>Significand</th></tr>
<tr style='text-align:center'><td>0</td><td>11111111111</td><td style='white-space:nowrap'><code>d0-d51</code> in <i>little-endian</i> order</td></tr>
</table></div>
<div>
For setting the sign bit, see <a href="../CBORNonFinite.html#setSign(boolean)"><code>CBORNonFinite.setSign(boolean)</code></a>.
</div>
<div style='margin-top:0.7em'>
The reason for <i>reversing</i> the payload bits is to ensure that a specific bit will remain
in a fix position (maintain the same value), independent of the size of the
<span style='white-space:nowrap'><code>IEEE</code> <code>754</code></span> variant used for encoding.
</div>
<div style='margin-top:0.7em'>
Note that the encoder will (due to CBOR deterministic encoding rules), select
the shortest serialization required to properly represent the payload.
The following table shows a few examples:
</div>
<div class='webpkifloat'><table class='webpkitable' style='margin-left:2em'>
<tr><th>Payload (hex)</th><th>CBOR Encoding</th><th>Diagnostic Notation</th></tr>
<tr><td style='text-align:right'><code>0</code></td><td style='text-align:right'><code>f97c00</code></td><td><code>Infinity</code></td></tr>
<tr><td style='text-align:right'><code>1</code></td><td style='text-align:right'><code>f97e00</code></td><td><code>NaN</code></td></tr>
<tr><td style='text-align:right'><code>2</code></td><td style='text-align:right'><code>f97d00</code></td><td><code>float'7d00'</code></td></tr>
<tr><td style='text-align:right'><code>3ff</code></td><td style='text-align:right'><code>f97fff</code></td><td><code>float'7fff'</code></td></tr>
<tr><td style='text-align:right'><code>400</code></td><td style='text-align:right'><code>fa7f801000</code></td><td><code>float'7f801000'</code></td></tr>
<tr><td style='text-align:right'><code>7fffff</code></td><td style='text-align:right'><code>fa7fffffff</code></td><td><code>float'7fffffff'</code></td></tr>
<tr><td style='text-align:right'><code>800000</code></td><td style='text-align:right'><code>fb7ff0000010000000</code></td><td><code>float'7ff0000010000000'</code></td></tr>
<tr><td style='text-align:right'><code>fffffffffffff</code></td><td style='text-align:right'><code>fb7fffffffffffffff</code></td><td><code>float'7fffffffffffffff'</code></td></tr>
</table></div>
A payload of <code>0</code> and having the sign bit set, would encode as <code>f9fc00</code> (<code>-Infinity</code>).</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><i>2005-2025 WebPKI.org.</i></small></p>
</footer>
</div>
</div>
</body>
</html>
